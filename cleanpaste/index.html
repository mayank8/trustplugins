<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CleanPaste - Sanitize Text</title>
    <meta name="description"
        content="CleanPaste is a privacy-first tool to remove zero-width characters, fix PDF line breaks, and strip formatting from text.">
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@400;600&display=swap"
        rel="stylesheet">
    <link rel="icon" type="image/png" href="assets/logo.png">
</head>

<body>
    <!-- Duplicate header removed -->

    <div class="app-container">
        <!-- Header replaced by id="app-header" above, but we need to structure app-container correctly.
             The sidebar layout expects app-container to wrap everything including header?
             Let's check style.css. 
             .app-container is flex column min-h 100vh.
             header is flex row.
             
             If I put #app-header outside app-container, I might break the flex layout if app-container is 100vh.
             Let's put #app-header INSIDE .app-container.
        -->
        <div class="app-container">
            <!-- Header will be injected by layout.js -->
            <div id="app-header"></div>

            <main class="main-layout">
                <aside class="sidebar">
                    <div class="sidebar-header">
                        <img src="assets/logo.png" alt="CleanPaste Logo" class="app-logo" width="64" height="64">
                        <h1 class="app-title">CleanPaste</h1>
                        <p class="app-description">Remove AI fingerprints & hidden chars.</p>
                        <div class="divider"></div>
                        <h2>Configuration</h2>
                    </div>
                    <div class="controls">
                        <label class="toggle-control">
                            <input type="checkbox" id="remove-hidden" checked>
                            <span class="toggle-track"></span>
                            <span class="label-text">Remove Hidden AI Artifacts</span>
                            <span class="info-tooltip"
                                title="Removes zero-width spaces and other invisible characters.">?</span>
                        </label>

                        <label class="toggle-control">
                            <input type="checkbox" id="fix-pdf">
                            <span class="toggle-track"></span>
                            <span class="label-text">Fix Broken Lines (PDF Mode)</span>
                            <span class="info-tooltip"
                                title="Fixes line breaks from PDFs while preserving paragraphs.">?</span>
                        </label>

                        <label class="toggle-control">
                            <input type="checkbox" id="remove-emojis">
                            <span class="toggle-track"></span>
                            <span class="label-text">Remove Emojis</span>
                        </label>

                        <div class="control-group">
                            <span class="group-label">Capitalization</span>
                            <select id="caps-mode">
                                <option value="none">Don't Change</option>
                                <option value="sentence">Sentence Case</option>
                                <option value="title">Title Case</option>
                                <option value="lower">lowercase</option>
                                <option value="upper">UPPERCASE</option>
                            </select>
                        </div>
                    </div>

                    <div class="stats-panel">
                        <div class="stat-item">
                            <span class="stat-label">Chars</span>
                            <span id="char-count" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Words</span>
                            <span id="word-count" class="stat-value">0</span>
                        </div>
                    </div>
                </aside>

                <section class="editor-area">
                    <textarea id="text-input" placeholder="Paste your text here..." autofocus></textarea>
                    <div class="action-bar">
                        <button id="clear-btn" class="btn secondary">Clear</button>
                        <button id="clean-copy-btn" class="btn primary">
                            <span class="btn-text">Clean & Copy</span>
                            <span class="btn-icon">â†µ</span>
                        </button>
                    </div>
                </section>
            </main>

            <div id="app-footer"></div>
        </div>

        <div id="toast" class="toast hidden">Copied to clipboard!</div>

        <!-- Shared Layout -->
        <script src="../layout.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                Layout.renderHeader({
                    rootPath: '..',
                    activePage: 'cleanpaste',
                    customMenuItems: [
                        { label: 'Settings', id: 'mobile-settings-toggle', href: '#' }
                    ]
                });
                Layout.renderFooter({ rootPath: '..' });
            });
        </script>

        <script src="script.js"></script>
        <script>
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('SW registered'))
                    .catch(err => console.log('SW registration failed', err));
            }
        </script>
</body>

</html>